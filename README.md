# О проекте


Приложение на FastAPI, которое при реквесте /metric - отдает результат рассчета формулы меткики


Эндпоинты:
* по эндпоинту http://127.0.0.1:8000/metric получаем значение по метрике по всей базе
* по эндпоинту http://127.0.0.1:8000/metric/?tags=all получаем массив тегов и меткрику каждого тега;
* по эндпоинту http://127.0.0.1:8000/metric/?tags={tag_id} получаем метрику конкретного тега.

# Подготовительные работы
## Создание виртуального окружения
```
pythone3 -m venv venv
```

## Ативация виртуального окружения
```
source venv/bin/activate
```

## Установка зависимостей
```
pip install -m requirements.txt
```

# Запуск проекта
## Переходим в директорию app/
```
cd app
```

## Проверка docker
По умолчанию проект запускается в докере. Перед запуском проекта нужно убедиться, что докер
установлен. Открой любой терминал и выполни следующую команду:
```
docker --version
```
Должна быть выведена версия докера, это выглядит примерно так:
```
Docker version 20.10.21, build baeda1f
```
Если докер не установлен, то установи его, следуя [инструкции](https://docs.docker.com/get-docker/).


## Настройка переменных окружения
Переменные окружения проекта хранятся в файле `.env`, для которого есть шаблон `.env.template`.
Создай в директории app/ файл `.env` простым копированием файла `.env.template`.


## Запуск сервисов
Для запуска проекта выполни следующую команду:
```
docker-compose up -d
```

Остановить и удалить запущенные контейнеры:
```
docker-compose down
```

## Управление миграциями базы данных

Применить миграции:
```
alembic upgrade head
```

## Запуск и отладка

Сначала остановим все запущенные контейнеры:
```
docker-compose down
```
Запустим базу данных:
```
docker-compose up -d
```
Теперь можно запустить сам сервис:
```
uvicorn main:app --reload
```



